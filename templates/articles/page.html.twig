{% extends 'base.html.twig' %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('styles/article.css') }}" >
{% endblock %}

{% block body %}

<!-- En-tête -->
<header>
    <div class="container">
        <h1>
            <nav>
                <ul>
                    <a href="accueil.html">
                        <img src="img/logoSpaceConnect.webp" width="60px" alt="Logo SpaceConnect">
                    </a>
                    <a href="accueil.html">SpaceConnect</a>
                </ul>
            </nav>
        </h1> 
        
        <!-- Bouton pour les petits écrans -->
        <button class="menu-toggle" aria-label="Menu">
            <i class="fa fa-bars"></i>
        </button>

        <!-- Menu de navigation -->
        <nav class="nav-menu">
            <ul>
                <li>
                    <form class="search-form" action="recherche.html" method="get">
                        <input type="text" name="query" placeholder="Rechercher...">
                        <button type="submit"><i class="fa fa-search"></i></button>
                    </form>
                </li>
                <li><a href="quizz.html">Quizz</a></li>
                <li><a href="Support.html">Support</a></li>
                <li><a href="forum.html">Forum</a></li>
                <li class="dropdown">
                    <a href="#" class="header-profil"><i class="fa fa-user fa-lg"></i></a>
                    <div class="dropdown-child">
                        <a href="profile .html">Profile</a>
                        <a href="inscription.html">Se connecter</a>
                    </div>
                </li>
            </ul>
        </nav>
    </div>
</header>

<section class="hero">
    <h2>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</h2>
    <p>Une introduction captivante à l'article...</p>
</section>

<article>
    <div class="container">
        <h2>Titre de l'Article</h2>
        <p><strong>Auteur:</strong> Jean Dupont</p>
        <p><strong>Date:</strong> 30 octobre 2024</p>
        <img src="img/alientiktok.jpg" alt="Image d'article" class="centered-image">
        
        <p>{{ article.content }}</p>        
        <h3>Sous-titre</h3>
        <p>{{ article.category}}</p>

        <h3>Conclusion</h3>
        <p>Phasellus libero justo, vulputate in ullamcorper in, aliquet in erat. Donec quis velit vel sem fermentum tincidunt a sed felis.</p>
    </div>
</article>

<!-- Section des commentaires -->
<section class="comments-section">
    <h3>Commentaires</h3>

    <!-- Affichage dynamique des commentaires -->
    <div class="comment">
        <div class="comment-header">
            <p><strong>Utilisateur1</strong> - 30 octobre 2024</p>
        </div>
        <div class="comment-body">
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
        </div>
    </div>

    <div class="comment">
        <div class="comment-header">
            <p><strong>Utilisateur2</strong> - 31 octobre 2024</p>
        </div>
        <div class="comment-body">
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
        </div>
    </div>

    <!-- Formulaire de commentaire -->
    <form class="comment-form">
        <label for="comment-author">Nom</label>
        <input type="text" id="comment-author" name="author" required placeholder="Votre nom">

        <label for="comment-content">Commentaire</label>
        <textarea id="comment-content" name="content" required placeholder="Écrivez votre commentaire..."></textarea>

        <button type="submit">Publier</button>
    </form>

    <p class="comment-count">2 commentaires</p>
</section>

 <!-- Pied de page -->
 <footer>
    <div class="container">
        <p>&copy; SpaceConnect. Tous droits réservés.</p>
        <nav>
            <ul>
                <li><a href="mentionslegales.html">Mentions légales</a></li>
                <li><a href="politique.html">Politique de confidentialité</a></li>
                <li><a href="conditionUtilisation.html">Conditions d'utilisation</a></li>
            </ul>
        </nav>
        <div class="social-media">
            <p>Suivez-nous sur nos réseaux :</p>
            <ul>
                <li><a href="https://www.facebook.com/?locale=fr_FR" target="_blank">Facebook</a></li>
                <li><a href="https://x.com/?lang=fr" target="_blank">Twitter</a></li>
                <li><a href="https://www.instagram.com/" target="_blank">Instagram</a></li>
                <li><a href="https://www.linkedin.com/in/axel-jean-denis-681822213/?trk=opento_nprofile_details" target="_blank">LinkedIn</a></li>
            </ul>
        </div>
    </div>
</footer>

<!-- Script pour le menu responsive -->
<script>
    const toggleButton = document.querySelector('.menu-toggle');
    const navMenu = document.querySelector('.nav-menu');

    toggleButton.addEventListener('click', () => {
        navMenu.classList.toggle('open');
    });
</script>

    <h1>{{ article.title }}</h1>
    <p><strong>Catégorie :</strong> {{ article.category }}</p>
    <div>
        <p>{{ article.content }}</p>
    </div>

    <h3>Commentaires</h3>

    {# Affichage des commentaires associés à l'article #}
    {% for commentaire in article.commentaires %}
        <div>
            <p>{{ commentaire.content }}</p>
            <small>Posté par {{ commentaire.user }}</small>

            {% if commentaire.user == app.user or is_granted('ROLE_ADMIN') %}
                {# Formulaire de modification du commentaire (visible pour l'auteur ou les administrateurs) #}
                <form method="POST" action="{{ path('article_page', {id: article.id}) }}">
                    <input type="hidden" name="commentaire_id" value="{{ commentaire.id }}">
                    <textarea name="content" rows="5" class="form-control">{{ commentaire.content }}</textarea>
                    <input type="hidden" name="action" value="edit">
                    <button type="submit" class="btn btn-warning">Modifier</button>
                </form>

                {# Formulaire de suppression du commentaire (visible pour l'auteur ou les administrateurs) #}
                <form method="POST" action="{{ path('article_page', {id: article.id}) }}" style="display:inline;" onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer ce commentaire ?');">
                    <input type="hidden" name="commentaire_id" value="{{ commentaire.id }}">
                    <input type="hidden" name="action" value="delete">
                    <button type="submit" class="btn btn-danger">Supprimer</button>
                </form>
            {% endif %}
        </div>
    {% endfor %}

    {# Formulaire d'ajout d'un nouveau commentaire #}
    {% if app.user %}
        <h3>Ajouter un commentaire</h3>

        <form method="POST" action="{{ path('article_page', {id: article.id}) }}">  {# Envoi du formulaire à l'URL actuelle de l'article #}
            <div class="form-group">
                <label for="content">Contenu du commentaire</label>
                <textarea id="content" name="content" class="form-control" rows="5"></textarea>
            </div>

            <button type="submit" class="btn btn-primary">Ajouter</button>
        </form>

    {% else %}
        <p>Vous devez être connecté pour ajouter un commentaire.</p>
    {% endif %}
{% endblock %}
